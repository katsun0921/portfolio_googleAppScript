<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <div>
    <select id="list" multiple>
      <option value="いちご">いちご</option>
      <option value="りんご">りんご</option>
      <option value="ブルーベリー">ブルーベリー</option>
    </select>
  </div>
  <div>
    <label for="cell">Cell Id</label>
    <input type="text" id="cell" minlength="2" maxlength="2" size="10">
  </div>
  <div>
    <button onclick="submit()">決定</button>
  </div>
  <script>
    window.onload = function() {
      google.script.run
      .withSuccessHandler(success)// 成功時のハンドラ
      .withFailureHandler(failure) // 失敗時のハンドラ
      .getValue();
    }

    function success(value) {
      console.log(value);
    }

    function failure (value) {
      console.log(`failure: ${value}`);
    }

    function submit() {
      const list = document.getElementById("list");
      const cell = document.getElementById("cell");
      const arr = [];
      for ( const item of list ) {
        if ( item.selected ) { arr.push(item.value); }
      }
      const cellId = cell.value;
      const opts = {
        cellId,
        items: arr.join(",")
        };
      google.script.run.setSelectedValues(opts);
      google.script.host.close();
    }
  </script>
  </body>
</html>
